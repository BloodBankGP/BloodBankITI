@model  BloodBankITI.Models.Post

@{
    ViewBag.Title = "title";
    Layout = "~/Views/Shared/_Layout2.cshtml";
}


<head>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
</head>

<h2>Requests</h2>

<div id="requests">

</div>

<script>
    var nid = @Model.BID
    var name = '@Html.Encode(@Model.Name)'
    setInterval(ajax, 1000);
    function ajax(){
        $.ajax({
            url: 'http://www.bloodservice.somee.com/Home/NeederRequests/' + nid+"/" + name ,
            type: 'GET',
            dataType: 'json',
            success: function (data) {

                WriteResponse(data);
            },
            error: function (e) {
                alert(e.statusText);
            }
        });


    };

    function WriteResponse(data) {

        
            var result= "";
            $.each(data, function (index, requests) {
                if (requests.Fname == "Wrong URL")
                {
                    result ="هذا الرابط غير صحيح";
                }
                else
                {
                    result += "<div>"+ requests.Fname+" "+requests.Lname+" accepted your request <br> Phone : "+requests.Phone+"</div>";
            
                }});
            $('#requests').html(result);
    }
</script>
